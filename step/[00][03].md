# 真正的注册与登录

## 思路
1.注册

思路：
(1)用户填好信息，点击<申请契约>按钮后，注册信息被发送至服务器

(2)格式检查后，查询用户是否已存在;存在就终止契约的签定,返回错误信息

(3)不存在就建立契约，即向数据库插入一个字段，返回插入的结果

(4)根据结果，返回契约的申请结果。

2.登录

思路：
(1)用户将契约信息发送至服务器

(2)服务器检测契约信息格式

(3)查询契约是否存在

(4)不存在，返回错误信息；存在，使用session来完成登录功能

## 数据库查询
上面所描述的操作关键是向数据库进行查询。

因此，数据库信息是必需的，于是要向 core/database.php 写入以下信息

[p1]

为了能够调用，在根目录index.php中加入

[p2]

在load.php中加入

[p3]

在common.php中加入

[p4]

这样就是 index.php -> load.php -> common.php ->(database.php + database_query.php)

=======================
接下来就是数据库的处理函数了(database_query.php)。

#注册
1.数据库要先连接才能用，所以为了避免每次操作都要用一堆代码来连接，可以将它写为一个函数，类似这样：
[p5]

然后，在class内部就能用 $this->connection() 来连接了

2.然后，就是需要定义一个执行查询的函数（所有的查询都将使用此函数，但是语句是不一样的）
如下：
[p6]

3.用户注册时，服务器判断用户是否存在要使用用户名来查询，不可用账号+密码来查询
定义一个名为 get_id 的函数(需要用户名参数)，只要能查出该用户名的id，说明用户存在
[p8]

4.开始创建用户
以此，定义一个名为 creat_user 的函数(需要用户名、密码参数,以后用数组传递数据)，
如：
[p7]

[其实这样并不安全，因为密码是以明文的形式储存在数据库中的，以后会进行md5加密处理之类的安全处理]

#登录
1.与确定用户名是否存在类似，不过这需要用户名与密码两个参数
返回布尔值即可
[p9]

至此数据库函数解决了

========================
php文件处理

1.注册：
将之前 向数据库增加信息 修改至如下：
[p10]

2.登录：
同样的将 
echo '提交的用户名：'.$username;
echo '提交的密码：'.$password;
修改至如下：
[p11]

此处注意，使用session需要在load.php中提前执行session_start();
如下：
[p12]

3.退出：
common.php中加入
[p18]

在logout.php中直接调用
[p19]

至此，粗略的注册登录功能已实现

========================
完善模板调用以及用户名的显示

为了免去每次写页面时都弄一下头部，因此，可以试图以一个 get_header() 函数的形式调用头部（页脚也一样）。
其中，$title参数为页面名称
要将函数加载在 common.php 中，像这样:
[p13]

header.php若登录就显示用户名
[p14]

footer.php
[p15]

然后在相应页面中调用如：get_header('注册');

==========================
这是效果：
未登录[p16]
已登录[p17]


完了。。。
